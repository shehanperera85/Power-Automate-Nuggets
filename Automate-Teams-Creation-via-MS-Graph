**Goal of this flow:** To be able to automate the Teams creation by ingesting the preferred template.

Often times the issue with the IT Admins is with the ever growing Teams popularity, how to beat the demand and how to create Teams and specially, how to template it out and automate it.
Well, Teams templates are now in the Teams Admin Center where you can see pre-defined templates and the ability to cerate custom templates if required.
With the templates, IT admins have to potentially provide the users the ability create Teams and then advice them to create a Team with a template. This will also give them the opportunity to create more Teams without the knowledge of the IT.
Microsoft have introduced Teams templates sometime ago so the Admins can use the pre-defined ones or custom ones according to the user requirement. The idea is to bring uniformity across the board.
Template can bundle up Channels, Tabs and Apps

When Powershell fails, MS Graph comes to rescue! Why I say this is when you run the new-team command with the -template parameter, it will throw an error if you are not an Education customers (namely if you don't have EDU_Class" or "EDU_PLC licenses)
Of course you can use powershell to run MS Graph, but what I'm showcasing is a way to automate Teams creation via MS Graph using Power Automate.

Skip to content
Search or jump to…
Pull requests
Issues
Marketplace
Explore
 
@shehanperera85 
shehanperera85
/
Automate-Teams-Creation-via-MS-Graph
Public
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Settings
Automate-Teams-Creation-via-MS-Graph
/
IntroAndPrereqs.md
in
main
 

Spaces

2

Soft wrap
1
# Create Teams via Microsoft Graph
2
​
3
​
4
# What you need?
5
1. Register Power Automate as an Azure AD App and provide permissions to MS Graph 
6
2. Pre Defined Teams Templates
7
3. Microsoft Forms
8
4. Excel Online Workbook
9
5. Power Automate
10
​
11
## 1. Register Power Automate as an Azure AD App
12
​
13
For later activities you need to perform in Power Automate using MS Graph, you ned to make sure Power Automate is registered as an app by providing the consent.
14
​
15
You need **Global Admin** access to perform this action.
16
​
17
Go to Azure AD portal > App registrations > New Registration >
18
Provide the app name (eg: **Power_Automate_Graph_API**)
19
Supported Account Types: **Accounts in this organizational directory only**
20
Press **Register**
21
​
22
<img width="658" alt="image" src="https://user-images.githubusercontent.com/98259062/153370392-e32becc0-35d0-4375-8048-3d9abb47801a.png">
23
​
24
**Note down the Client ID of the APP**
25
​
26
<img width="796" alt="image" src="https://user-images.githubusercontent.com/98259062/153370593-57d2806e-4c71-46fb-90b8-bec6cf4baa3f.png">
27
​
28
### Secret
29
Go to **Certificates and Services** > **New Client Secret** > Set the name and expiration period
30
**note down the Secret (Value)**
31
​
32
<img width="950" alt="image" src="https://user-images.githubusercontent.com/98259062/153370243-70d100db-96f5-492f-a24d-76a74aaca6ad.png">
33
​
34
​
35
Now go to **API permissions**
36
Go to **Add a permission** > select **MS Graph** > select **Application permissions**
37
​
38
According to the official MS Documentaion, the below permissions requires for the applocation
39
Team.Create, Teamwork.Migrate.All, Group.ReadWrite.All**, Directory.ReadWrite.All**
40
​
41
Once the above permissions are added, provide **Admin consent**
42
​
43
This completes the app registration and providing MS Graph the necessary permissions.
44
​
45
<img width="746" alt="image" src="https://user-images.githubusercontent.com/98259062/153370747-cdc973a3-75f9-48a1-8de4-40b885e9b545.png">
No file chosen
Attach files by dragging & dropping, selecting or pasting them.
@shehanperera85
Commit changes
Commit summary
Create IntroAndPrereqs.md
Optional extended description
Add an optional extended description…
 Commit directly to the main branch.
 Create a new branch for this commit and start a pull request. Learn more about pull requests.
 
© 2022 GitHub, Inc.
Footer navigation
Terms
Privacy
Security
Status
Docs
Contact GitHub
Pricing
API
Training
Blog
About
